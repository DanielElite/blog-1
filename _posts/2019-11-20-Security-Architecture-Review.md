---
layout: post
title:  再谈安全架构评审
categories: 安全工程师
kerywords:  企业安全 互联网企业安全 架构评审
tags:  安全架构
---

时间久了，看事情的视野也就不一样了。回顾以前的一些思路，可能也会有新的见识。同样，拿安全架构评审而言。目前又有了新的体会。
那么我们首先要知道的是，安全架构评审的意义是什么，最原始的是为了在**项目初期发现潜在的威胁，提出对应的解决对策**。 其次在另一方面也是提升了安全团队的影响力，当然，好的输出就是提高影响力，提高话语权。平平常常的话也仅仅是刷存在感。而且很多时候由于安全架构评审人员的问题过于随意，时而深入应用漏洞技术细节，时而考虑架构。天马星空，想到啥问啥，缺乏体系化的评审。在SDL上来看，其实第一步就没做好。那么怎么样才能够更好的输出？在知道了为了什么之后，还要记住的一点就是，如何使项目架构朝着预期方式发展，前提还要是是能看到这么远，不一定在这个阶段实施，但要在架构阶段提出。根据WHY， WHAT，HOW原则来看。

* WHY
1. 确保在初期发现潜在风险并缓解
2. 提高安全部门的存在感
* WHAT
1. 架构评审会
2. 安全研发培训
3. 黑白盒扫描器
4. 漏洞运营
* HOW
1. 根据设计域风险检查，针对大型项目做威胁建模
2. 输出安全意识，安全架构知识等
3. 引入相关的安全产品
4. 针对输出进行闭环检验

相对于架构师而言，安全架构师不仅要了解架构的基础知识，还需要了解安全知识。那么在做架构评审的时候，最原始最能最直接能够体现业务方的就是相应的架构图：

* 业务领域图
* 系统依赖图
* 数据流程图
* 物理部署图

通过架构图可以很直接了解业务逻辑，物理部署，数据流向等等，熟练的安全架构师能够直接在心里面发现对应的问题点。也就是所谓的知己知彼，百战不殆。当然还有一部分依赖于踩坑的经历。**在了解整体架构之后，威胁建模步骤的应该是要首先分解应用程序，发现外部依赖关系，找到入口点，分析服务使用了哪些资产，因此产生的攻击面，针对相应的数据流进行分析等。**（你他娘的还真是个人才，说的跟教科书似的）。当然这只是理论，还是要参考设计域，以及相关Checklist。从系统功能，系统部署，系统依赖等等去分析威胁，威胁建模自古习惯STRIDE，就不多做介绍了。那么威胁怎么分出轻重缓急呢？可以参考微软提出的DREAD

![image](https://user-images.githubusercontent.com/12653147/69245770-6f893980-0be2-11ea-8b6c-b1738106e538.png)

但是在大公司中，架构评审可能应接不暇。业务迭代变更非常快，每周都会有几场架构评审，怎么提升效率呢？如果想要提升效率，首先要看看输出点有哪些。

* 立项前架构评审（风险识别）
* 研发前安全培训 （研发部门安全研发，QA部门安全测试，重灾区专项治理）
* 发布前后安全产品持续部署(完全可以自动化，WAF，HIDS，黑白盒扫描，数据库审计等）
* 人工代码审计
* 上线后漏洞运营

**把能自动化的自动化掉，比如说安全产品的部署，和黑白盒的扫描。不能自动化的转移能力，把相关的能力扩散到测试部门，研发部门，使其具有安全属性。再最后把既不能自动化也不能转移的能力沉淀出知识库和案例库。这是第一步，第二步就是追踪结果，根据结果建立正向的反馈，驱动或者推动其他团队继续跟着转。**

当然还有一些细节没有写，以及相关的架构评审表也没有贴出来，天气是越发的冷了，寒冷容易使人头脑不够清醒，收拾收拾睡了，合格的安全从业者不多，合格的安全架构师就更少了。相信当你具备这些视野的时候，很多事情自己做起来也没有那么困难。